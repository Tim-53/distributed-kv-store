implement seq_number
refactor to use consistent result as return
use seq number in reads
implement compaction
use seq number and compaction
